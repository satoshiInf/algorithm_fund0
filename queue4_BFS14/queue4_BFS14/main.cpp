//
//  main.cpp
//  queue4_BFS14
//
//  Created by Satoshi on 8/3/25.
//

#include <iostream>
#include <queue>
#include <vector>

int main()
{
    std::vector<std::vector<int>> graph
    =
    {
        {1, 2},     // 0 â†’ 1, 2
        {3},        // 1 â†’ 3
        {3},        // 2 â†’ 3
        {4},        // 3 â†’ 4
        {}          // 4ï¼ˆçµ‚ç‚¹ï¼‰
    };
    
    int n = static_cast<int>(graph.size() );
    std::vector<int> distance(n, -1);
    std::vector<int> count(n, 0);
    std::vector<int> prev(n, -1);
    
    std::queue<int> q;
    distance[0] = 0;
    count[0] = 1;//çµŒè·¯æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹
    q.push(0);
    
    
    while(!q.empty() )
    {
        int node = q.front();
        q.pop();
        
        std::cout<< node <<std::endl;
        
        for(int next : graph[node])
        {
            if(distance[next]== -1) //åˆæœŸçŠ¶æ…‹ã§ã€ã¾ã è·é›¢ãŒæœªç¢ºå®šã®ãƒãƒ¼ãƒ‰ã¯ -1 ã«è¨­å®šã€‚
            {
                distance[next] = distance[node] +1;
                count[next] = count[node];
                prev[next] = node;
                q.push(next);
                /*
                 èƒŒæ™¯
                 count[i] ã¯ ãƒãƒ¼ãƒ‰ i ã«æœ€çŸ­è·é›¢ã§åˆ°é”ã™ã‚‹çµŒè·¯ã®æœ¬æ•° ã‚’è¡¨ã—ã¾ã™ã€‚
                 BFSã§ãƒãƒ¼ãƒ‰ã‚’è¨ªã‚Œã‚‹ã¨ãã€æœ€çŸ­è·é›¢ãŒæ±ºã¾ã£ãŸã¨åŒæ™‚ã«ã€ãã®ãƒãƒ¼ãƒ‰ã«åˆ°é”ã™ã‚‹çµŒè·¯ã®æ•°ã‚‚è¨ˆç®—ã—ã¾ã™ã€‚
                 ãªãœ count[next] = count[node]; ãªã®ã‹ï¼Ÿ
                 ãƒãƒ¼ãƒ‰ next ã« åˆã‚ã¦ æœ€çŸ­è·é›¢ãŒç¢ºå®šã—ãŸã¨ãã€
                 next ã¸ã¯ ä»Šã®ãƒãƒ¼ãƒ‰ node ã‚’çµŒç”±ã—ã¦åˆ°é” ã™ã‚‹ã®ã§ã€
                 node ã¾ã§ã®çµŒè·¯æ•°ãŒãã®ã¾ã¾ next ã¸ã®çµŒè·¯æ•°ã«ãªã‚Šã¾ã™ã€‚
                 ã¤ã¾ã‚Šã€
                 count[next] = count[node];ã¯
                 ã€Œãƒãƒ¼ãƒ‰ next ã«æœ€çŸ­è·é›¢ã§åˆ°é”ã™ã‚‹çµŒè·¯æ•°ã¯ã€ä»Šã„ã‚‹ãƒãƒ¼ãƒ‰ node ã¾ã§ã®çµŒè·¯æ•°ã¨åŒã˜ã ã‚ˆã€
                 ã¨ã„ã†æ„å‘³ã§ã™ã€‚
                 ã‚‚ã—ãƒãƒ¼ãƒ‰0ã‹ã‚‰ãƒãƒ¼ãƒ‰1ã¸ã¯çµŒè·¯æ•°ãŒ1é€šã‚Šï¼ˆ0â†’1ï¼‰
                 ãƒãƒ¼ãƒ‰1ã‹ã‚‰ãƒãƒ¼ãƒ‰3ã¸æ–°ãŸã«åˆ°é”ã—ãŸã¨ãã€
                 ãƒãƒ¼ãƒ‰3ã«å¯¾ã™ã‚‹çµŒè·¯æ•°ã¯ã€ãƒãƒ¼ãƒ‰1ã¾ã§ã®çµŒè·¯æ•°ï¼ˆ1é€šã‚Šï¼‰ã¨åŒã˜æ•°ã«ãªã‚Šã¾ã™ã€‚
                 ã¾ã¨ã‚
                 count[next] = count[node]; ã¯ åˆã‚ã¦ãã®ãƒãƒ¼ãƒ‰ã«åˆ°é”ã—ãŸã¨ãã®çµŒè·¯æ•°ã®åˆæœŸåŒ– ã®å½¹å‰²ã§ã™ã€‚
                 ã“ã‚Œä»¥é™ã€åŒã˜æœ€çŸ­è·é›¢ã§ä»–ã®çµŒè·¯ã‹ã‚‰ã‚‚åˆ°é”å¯èƒ½ãªã‚‰ã€çµŒè·¯æ•°ã‚’åŠ ç®—ã—ã¦ã„ãã¾ã™ã€‚
                 */
                
                
            }
            else if(distance[next] == distance[node]+1)
            {
                count[next] += count[node];
                
            }
                /*
                
                  _ 4é€šã‚Š
               1 |_|
                 3
                 
                 ã‚ãªãŸã®å›³ã‚’ä½¿ã£ã¦ã€ã‚‚ã†å°‘ã—è©³ã—ãè§£èª¬ã—ã¾ã™ã­ï¼š
                       0
                      / \
                     1   2
                      \ /
                       3
                       |
                       4
                 ğŸŒ± çŠ¶æ³ã®æµã‚Œï¼ˆãƒãƒ¼ãƒ‰ã”ã¨ï¼‰
                 æœ€åˆã«ã‚¹ã‚¿ãƒ¼ãƒˆï¼š
                 count[0] = 1ï¼ˆé–‹å§‹ç‚¹ãªã®ã§ï¼‰
                 ãƒãƒ¼ãƒ‰1ã¨2ã«åˆ°é”ï¼š
                 ä¸¡æ–¹ã¨ã‚‚è·é›¢ = 1ã€count[1] = count[2] = 1

                 ãƒãƒ¼ãƒ‰3ã«åˆ°é”ï¼ˆ1â†’3ã®ã¨ãï¼‰ï¼š
                 distance[3] = 2
                 count[3] = count[1] = 1ï¼ˆåˆã‚ã¦åˆ°é”ï¼‰

                 ãƒãƒ¼ãƒ‰3ã«ã‚‚ã†ä¸€åº¦åˆ°é”ï¼ˆ2â†’3ã®ã¨ãï¼‰ï¼š
                 distance[3] == distance[2] + 1 ãŒæˆç«‹ â†’ åŒã˜æœ€çŸ­è·é›¢
                 â‡’ count[3] += count[2]
                 â‡’ count[3] = 1ï¼ˆã‚‚ã¨ã‚‚ã¨ï¼‰ + 1 = 2

                 ãƒãƒ¼ãƒ‰4ã«åˆ°é”ï¼ˆ3â†’4ï¼‰ï¼š
                 count[4] = count[3] = 2ï¼ˆãƒãƒ¼ãƒ‰3ã‹ã‚‰2é€šã‚Šæ¥ã‚‰ã‚Œã‚‹ï¼‰
                 */
    
            }
        }
    
    std::cout << "--- æœ€çŸ­è·é›¢ã¨çµŒè·¯æ•° ---\n";
    
    for(int i = 0 ; i < n; i++)
    {
        std::cout<<"ãƒãƒ¼ãƒ‰" << i <<"è·é›¢"<< distance[i] << ", çµŒè·¯æ•° = " << count[i] << "\n";
    }
    
    std::cout << "\n--- çµŒè·¯å¾©å…ƒ ---\n";
    for(int goal = 0; goal < n; goal++)
    {
        if(distance[goal] == -1)
        {
            continue;
        }
        std::vector<int>path;
        for(int cur = goal; cur!= -1; cur = prev[cur])
        {
            path.push_back(cur);
        }
        std::reverse(path.begin(), path.end());
        std::cout<< "0->" <<goal <<"çµŒç·¯";
        for(size_t i = 0; i <path.size(); i++)
        {
            std::cout<< path[i];
            if(i+1 < path.size())
            {
                std::cout<< "->";
            }
        }
        std::cout << "\n";
    }
    
    
    return 0;
}
