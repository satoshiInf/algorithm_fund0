//
//  main.cpp
/*
 ã§ã¯ã€å…ˆã»ã©ã®ã€Œæœ€çŸ­è·é›¢ã¨çµŒè·¯å¾©å…ƒï¼ˆBFSï¼‰ã€ã®ç†è§£ã‚’ã•ã‚‰ã«æ·±ã‚ã‚‹ãŸã‚ã® **ä½œæˆå•é¡Œï¼ˆé¡é¡Œï¼‰** ã‚’å‡ºã—ã¾ã™ã€‚
 ## ğŸ¯ é¡é¡Œï¼šæœ€çŸ­è·é›¢ã¨è¤‡æ•°çµŒè·¯æ•°ã®ã‚«ã‚¦ãƒ³ãƒˆ
 ### å•é¡Œ
 ä»¥ä¸‹ã®æœ‰å‘ã‚°ãƒ©ãƒ•ãŒä¸ãˆã‚‰ã‚Œã¾ã™ï¼š

 
 std::vector<std::vector<int>> graph =
 {
     {1, 2},     // 0 â†’ 1, 2
     {3},        // 1 â†’ 3
     {3},        // 2 â†’ 3
     {4},        // 3 â†’ 4
     {}          // 4ï¼ˆçµ‚ç‚¹ï¼‰
 };
 
 ãƒãƒ¼ãƒ‰ 0 ã‹ã‚‰å„ãƒãƒ¼ãƒ‰ã¸ã® **æœ€çŸ­è·é›¢** ã«åŠ ãˆã¦ã€
 **æœ€çŸ­è·é›¢ã§åˆ°é”ã™ã‚‹çµŒè·¯ã®æœ¬æ•°** ã‚‚æ±‚ã‚ã¦ãã ã•ã„ã€‚

 ---
 ### ğŸ”§ è¦æ±‚ã•ã‚Œã‚‹ã“ã¨
 * BFSã‚’ä½¿ã£ã¦ã€ãƒãƒ¼ãƒ‰0ã‹ã‚‰ã®æœ€çŸ­è·é›¢ã‚’æ±‚ã‚ã‚‹
 * åŒæ™‚ã«ã€Œãã®è·é›¢ã§åˆ°é”ã™ã‚‹æ–¹æ³•ãŒä½•é€šã‚Šã‚ã‚‹ã‹ã€ã‚’æ•°ãˆã‚‹
 * å‡ºåŠ›ä¾‹ã®ã‚ˆã†ã«ã€å„ãƒãƒ¼ãƒ‰ã«ã¤ã„ã¦è¡¨ç¤ºã™ã‚‹
 ---
 ### âœ… å‡ºåŠ›ä¾‹
 ãƒãƒ¼ãƒ‰ 0: è·é›¢ = 0, çµŒè·¯æ•° = 1
 ãƒãƒ¼ãƒ‰ 1: è·é›¢ = 1, çµŒè·¯æ•° = 1
 ãƒãƒ¼ãƒ‰ 2: è·é›¢ = 1, çµŒè·¯æ•° = 1
 ãƒãƒ¼ãƒ‰ 3: è·é›¢ = 2, çµŒè·¯æ•° = 2
 ãƒãƒ¼ãƒ‰ 4: è·é›¢ = 3, çµŒè·¯æ•° = 2

 > ãƒãƒ¼ãƒ‰3ã¸ã¯ã€0â†’1â†’3 ã¨ 0â†’2â†’3 ã®2é€šã‚Šã‚ã‚Šã¾ã™
 > åŒæ§˜ã«ã€ãƒãƒ¼ãƒ‰4ã¸ã‚‚2é€šã‚Šã§ã™

 ---

 ### ğŸ§  ãƒ’ãƒ³ãƒˆ

 * `std::vector<int> distance(n, -1);`
 * `std::vector<int> count(n, 0);` â† çµŒè·¯æ•°
 * æœ€åˆã¯ `distance[0] = 0`, `count[0] = 1`
 * `next` ã‚’è¨ªå•ã™ã‚‹éš›ï¼š

 ```cpp
 if (distance[next] == -1) {
     distance[next] = distance[node] + 1;
     count[next] = count[node];
     q.push(next);
 } else if (distance[next] == distance[node] + 1) {
     count[next] += count[node]; // åŒã˜æœ€çŸ­è·é›¢ãªã‚‰åŠ ç®—
 }

 ### âœï¸ å¿œç”¨ã‚¢ã‚¤ãƒ‡ã‚¢ï¼ˆä½™è£•ãŒã‚ã‚Œã°ï¼‰

 * åˆ°é”ã§ããªã„ãƒãƒ¼ãƒ‰ï¼ˆ`distance[i] == -1`ï¼‰ã®æ‰±ã„ã‚‚å‡ºåŠ›
 * ã‚°ãƒ©ãƒ•ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã¿è¾¼ã‚“ã§ã‚‚OK

 ã€Œå®Ÿè£…ã—ã¦ã¿ãŸã„ã€ã€Œç­”ãˆåˆã‚ã›ã—ãŸã„ã€ã¨æ€ã£ãŸã‚‰ã€ç¶šãã‚’ä¸€ç·’ã«ä½œã‚Œã¾ã™ã‚ˆã€‚ã‚„ã£ã¦ã¿ã¾ã™ã‹ï¼Ÿ

 */


//

#include <iostream>
#include <vector>
#include <queue>
#include <stack>

int main()
{
    std::vector<std::vector<int>> graph
    =
    {
        {1, 2},     // 0 â†’ 1, 2
          {3},        // 1 â†’ 3
          {3},        // 2 â†’ 3
          {4},        // 3 â†’ 4
          {}
    };
    
    int n = static_cast<int>(graph.size() );
    std::vector<bool> visited(n,false);
    visited[0] = true;
    
    std::queue<int> q;
    q.push(0);
    
    std::vector<int> distance(n, -1);
    std::vector<int> prev(n, -1);
    
    while(!q.empty())
    {
        int node = q.front();
        q.pop();
        std::cout << node << std::endl;
        
        //nodeã®è¦ç´ ã«å¯¾ã™ã‚‹å‡¦ç†
        for(int next: graph[node])
        {
            if(!visited[next])
            {
                visited[next] =true;
                q.push(next);
                distance[next] = distance[node]+ 1;
                prev[next] = node;
            }
        }
    }
    
    //åˆ°é”ã—ãŸã„ç›®çš„åœ°ãƒãƒ¼ãƒ‰ã‚’nodeã¨ã™ã‚‹
    //goalãŒï¼ã®æ™‚ã€œï¼”ã®æ™‚ã¾ã§
    
    std::cout << "--- æœ€çŸ­è·é›¢ ---\n";
    for(int i = 0; i < n ; i++)
    {
        std::cout << "Node " << i << ": è·é›¢ = " << distance[i] << std::endl;
    }
        
    
        /*
         goal ã‹ã‚‰å‡ºç™ºã—ã¦ã€prev ã‚’ãŸã©ã£ã¦ã€Œå‰ã®ãƒãƒ¼ãƒ‰ã€ã«æˆ»ã£ã¦ã„ã
         ãŸã©ã‚ŠãªãŒã‚‰ path ã«é †ç•ªã«è¿½åŠ ã—ã¦ã„ã
         æœ€å¾Œã¯ prev[cur] == -1 ã«ãªã‚Šã€ãƒ«ãƒ¼ãƒ—çµ‚äº†ï¼ˆå‡ºç™ºç‚¹ã«åˆ°é”ï¼‰
         */
        
    std::cout << "\n--- çµŒè·¯å¾©å…ƒ ---\n";
    for (int goal = 0; goal < n; goal++)
        {
            if (distance[goal] == -1 || goal == 0)
                continue; // æœªåˆ°é” or è‡ªåˆ†è‡ªèº«ã¯ã‚¹ã‚­ãƒƒãƒ—ã€€ //æ¬¡ã®å€¤ã§ã¾ãŸãƒ«ãƒ¼ãƒ—ã‚’å›ã™

            std::vector<int> path;
            for (int cur = goal; cur != -1; cur = prev[cur])
            {
                path.push_back(cur);
            }
            std::reverse(path.begin(), path.end());//ãã®ã¾ã¾pathã‚’å…¥ã‚Œæ›¿ãˆã‚‹
            /*
            ãŸã¨ãˆã°ï¼š
            ã‚‚ã— goal = 5 ã®ã¨ãã€prev ã®ä¸­èº«ãŒæ¬¡ã®ã‚ˆã†ã«ãªã£ã¦ã„ãŸã‚‰ï¼š
            prev[5] = 3
            prev[3] = 1
            prev[1] = 0
            prev[0] = -1
            ã“ã® for ã®ãƒ«ãƒ¼ãƒ—ã§ï¼š
            cur = 5 â†’ 3 â†’ 1 â†’ 0 â†’ çµ‚äº†
            ã“ã®æ™‚ç‚¹ã® path ã¯ [5, 3, 1, 0] ã«ãªã‚Šã¾ã™ï¼ˆé€†é †ï¼‰
            */
            
            std::cout << "0 â†’ " << goal << " ã®çµŒè·¯: ";
            for (size_t i = 0; i < path.size(); i++)
            {
                std::cout << path[i];
                if (i + 1 < path.size()) std::cout << " â†’ ";
            }
            std::cout << "\n";
    }

      
    return 0;
}
